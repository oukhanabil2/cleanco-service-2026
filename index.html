<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Syst√®me de Gestion des Agents (SGA) - CleanCo 2026</title>
    
    <!-- CSS principal -->
    <link rel="stylesheet" href="css/styles.css">
    
    <!-- Meta tags pour PWA -->
    <meta name="theme-color" content="#2c3e50">
    <meta name="description" content="Syst√®me de Gestion des Agents pour CleanCo Service 2026">
    <link rel="manifest" href="manifest.json">
    
    <!-- Styles de secours et de base -->
    <style>
        /* RESET et styles de base */
        * { 
            box-sizing: border-box; 
            margin: 0; 
            padding: 0; 
        }
        
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #34495e;
            --gray-color: #7f8c8d;
            --border-radius: 8px;
            --box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
        }
        
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif; 
            margin: 0; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            line-height: 1.6;
            color: #333;
        }
        
        /* Conteneur principal */
        .app-container { 
            max-width: 1400px; 
            margin: 0 auto; 
            padding: 20px;
            min-height: 100vh;
        }
        
        /* En-t√™te de l'application */
        .app-header { 
            background: rgba(255,255,255,0.97); 
            padding: 30px; 
            border-radius: 20px; 
            margin-bottom: 30px; 
            box-shadow: var(--box-shadow); 
            text-align: center;
            animation: slideDown 0.5s ease;
            border: 2px solid var(--primary-color);
        }
        
        .app-title { 
            color: var(--primary-color); 
            margin: 0 0 10px 0; 
            font-size: 2.8rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .app-subtitle { 
            color: var(--gray-color); 
            margin: 0; 
            font-size: 1.3rem;
            font-weight: 400;
        }
        
        .app-version {
            display: inline-block;
            background: var(--secondary-color);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-top: 10px;
            font-weight: 500;
        }
        
        /* Zone de contenu principale */
        #main-content {
            background: rgba(255,255,255,0.97);
            border-radius: 20px;
            padding: 30px;
            box-shadow: var(--box-shadow);
            animation: fadeIn 0.5s ease;
            min-height: 500px;
            position: relative;
        }
        
        /* √âtat de chargement */
        .loading-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 400px;
            text-align: center;
        }
        
        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--secondary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        /* Pied de page */
        .app-footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid rgba(255,255,255,0.2);
            color: white;
            font-size: 0.9rem;
        }
        
        .app-footer a {
            color: white;
            text-decoration: none;
            margin: 0 10px;
        }
        
        .app-footer a:hover {
            text-decoration: underline;
        }
        
        /* Messages d'erreur */
        .error-message {
            background: var(--danger-color);
            color: white;
            padding: 15px;
            border-radius: var(--border-radius);
            margin: 20px 0;
            text-align: center;
            animation: shake 0.5s ease;
        }
        
        /* Boutons */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: var(--secondary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .btn-secondary {
            background: var(--gray-color);
            color: white;
        }
        
        .btn-danger {
            background: var(--danger-color);
            color: white;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-50px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .app-container {
                padding: 10px;
            }
            
            .app-header {
                padding: 20px;
                margin-bottom: 20px;
            }
            
            .app-title {
                font-size: 2rem;
                flex-direction: column;
                gap: 10px;
            }
            
            .app-subtitle {
                font-size: 1.1rem;
            }
            
            #main-content {
                padding: 20px;
            }
        }
        
        @media (max-width: 480px) {
            .app-title {
                font-size: 1.8rem;
            }
            
            .app-subtitle {
                font-size: 1rem;
            }
            
            .btn {
                padding: 8px 16px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- En-t√™te de l'application -->
        <header class="app-header">
            <h1 class="app-title">
                <span>üìã</span>
                SGA CleanCo 2026
            </h1>
            <p class="app-subtitle">Syst√®me de Gestion des Agents - Version Professionnelle</p>
            <div class="app-version">Version 1.0.0</div>
        </header>
        
        <!-- Contenu principal dynamique -->
        <main id="main-content">
            <!-- √âtat initial de chargement -->
            <div class="loading-state" id="initial-loading">
                <div class="loading-spinner"></div>
                <h2 style="color: var(--primary-color); margin: 20px 0 10px 0;">Initialisation de l'application...</h2>
                <p style="color: var(--gray-color);">Chargement des modules et des donn√©es</p>
            </div>
            
            <!-- Titre dynamique (sera mis √† jour par JavaScript) -->
            <h2 id="sub-title" style="display: none;">Menu Principal</h2>
            
            <!-- Contenu sera inject√© ici par JavaScript -->
        </main>
        
        <!-- Pied de page -->
        <footer class="app-footer">
            <p>¬© 2024-2026 CleanCo Service. Tous droits r√©serv√©s.</p>
            <p>
                <a href="javascript:void(0)" onclick="showAbout()">√Ä propos</a> | 
                <a href="javascript:void(0)" onclick="showHelp()">Aide</a> | 
                <a href="javascript:void(0)" onclick="showPrivacy()">Confidentialit√©</a>
            </p>
        </footer>
    </div>

    <!-- === SCRIPTS DANS L'ORDRE D√âPENDANT === -->
    
    <!-- 1. Constantes et configuration -->
    <script src="js/constants.js"></script>
    
    <!-- 2. Gestionnaire de donn√©es -->
    <script src="js/dataManager.js"></script>
    
    <!-- 3. Gestionnaire d'interface -->
    <script src="js/uiManager.js"></script>
    
    <!-- 4. Modules optionnels (charg√©s dynamiquement plus tard) -->
    <!-- <script src="js/modules/agents.js"></script> -->
    <!-- <script src="js/modules/planning.js"></script> -->
    <!-- <script src="js/modules/leaves.js"></script> -->
    <!-- <script src="js/modules/statistics.js"></script> -->
    <!-- <script src="js/modules/panicCodes.js"></script> -->
    <!-- <script src="js/modules/radios.js"></script> -->
    <!-- <script src="js/modules/uniforms.js"></script> -->
    <!-- <script src="js/modules/warnings.js"></script> -->
    <!-- <script src="js/modules/holidays.js"></script> -->
    <!-- <script src="js/modules/export.js"></script> -->
    <!-- <script src="js/modules/config.js"></script> -->
    
    <!-- 5. Application principale -->
    <script src="js/main.js"></script>
    
    <!-- 6. Script d'initialisation et fonctions globales -->
    <script>
        // Fonctions globales pour le pied de page
        function showAbout() {
            if (window.uiManager) {
                uiManager.showPopup({
                    title: '√Ä propos de SGA CleanCo',
                    content: `
                        <div style="padding: 15px;">
                            <h3 style="color: var(--primary-color); margin-bottom: 15px;">Syst√®me de Gestion des Agents</h3>
                            <p><strong>Version :</strong> 1.0.0 (2026)</p>
                            <p><strong>D√©velopp√© pour :</strong> CleanCo Service</p>
                            <p><strong>Description :</strong> Application compl√®te de gestion des agents de nettoyage, planning, cong√©s et statistiques.</p>
                            <hr style="margin: 20px 0;">
                            <p><strong>Fonctionnalit√©s principales :</strong></p>
                            <ul style="margin-left: 20px;">
                                <li>Gestion des agents et √©quipes</li>
                                <li>Planification automatis√©e</li>
                                <li>Suivi des cong√©s et absences</li>
                                <li>Statistiques et rapports</li>
                                <li>Gestion des √©quipements</li>
                            </ul>
                        </div>
                    `,
                    size: 'medium'
                });
            } else {
                alert('√Ä propos de SGA CleanCo\nVersion 1.0.0\n¬© 2026 CleanCo Service');
            }
        }
        
        function showHelp() {
            if (window.uiManager) {
                uiManager.showPopup({
                    title: 'Aide et support',
                    content: `
                        <div style="padding: 15px;">
                            <h3 style="color: var(--primary-color); margin-bottom: 15px;">Centre d'aide</h3>
                            <p>Pour obtenir de l'aide :</p>
                            <ul style="margin-left: 20px; margin-bottom: 20px;">
                                <li><strong>Support technique :</strong> support@cleanco.com</li>
                                <li><strong>T√©l√©phone :</strong> +212 XXX XXX XXX</li>
                                <li><strong>Horaires :</strong> Lundi - Vendredi, 9h-18h</li>
                            </ul>
                            <hr style="margin: 20px 0;">
                            <p><strong>Raccourcis utiles :</strong></p>
                            <ul style="margin-left: 20px;">
                                <li><kbd>√âchap</kbd> : Retour au menu principal</li>
                                <li><kbd>F5</kbd> : Actualiser l'application</li>
                                <li><kbd>Ctrl + S</kbd> : Sauvegarder les donn√©es</li>
                            </ul>
                        </div>
                    `,
                    size: 'medium'
                });
            }
        }
        
        function showPrivacy() {
            if (window.uiManager) {
                uiManager.showPopup({
                    title: 'Politique de confidentialit√©',
                    content: `
                        <div style="padding: 15px; max-height: 400px; overflow-y: auto;">
                            <h3 style="color: var(--primary-color); margin-bottom: 15px;">Confidentialit√© des donn√©es</h3>
                            <p><strong>Collecte de donn√©es :</strong></p>
                            <p>Cette application stocke localement sur votre appareil :</p>
                            <ul style="margin-left: 20px; margin-bottom: 15px;">
                                <li>Informations sur les agents</li>
                                <li>Plannings et cong√©s</li>
                                <li>Historique des modifications</li>
                            </ul>
                            <p><strong>Stockage :</strong> Toutes les donn√©es sont stock√©es localement dans votre navigateur (localStorage). Aucune donn√©e n'est envoy√©e √† des serveurs externes.</p>
                            <p><strong>S√©curit√© :</strong> L'acc√®s √† l'application est prot√©g√© par mot de passe. Les donn√©es sont sauvegard√©es automatiquement.</p>
                            <p><strong>Suppression :</strong> Pour supprimer toutes les donn√©es, utilisez l'option "R√©initialiser" dans les param√®tres ou effacez le cache de votre navigateur.</p>
                        </div>
                    `,
                    size: 'medium'
                });
            }
        }
        
        // Gestion des erreurs globales
        window.addEventListener('error', function(event) {
            console.error('‚ùå Erreur globale:', event.error);
            
            const errorContainer = document.createElement('div');
            errorContainer.className = 'error-message';
            errorContainer.innerHTML = `
                <strong>Erreur :</strong> ${event.error.message || 'Erreur inconnue'}
                <br><small>Veuillez rafra√Æchir la page ou contacter le support.</small>
            `;
            
            const mainContent = document.getElementById('main-content');
            if (mainContent) {
                mainContent.appendChild(errorContainer);
            }
        });
        
        // Fallback si l'application ne se charge pas
        setTimeout(function() {
            const loading = document.getElementById('initial-loading');
            const subTitle = document.getElementById('sub-title');
            
            if (loading && loading.style.display !== 'none' && !window.mainApp) {
                loading.innerHTML = `
                    <div style="color: var(--danger-color); text-align: center;">
                        <h2>‚ö†Ô∏è D√©lai de chargement d√©pass√©</h2>
                        <p>L'application met trop de temps √† charger.</p>
                        <p>Veuillez v√©rifier :</p>
                        <ul style="text-align: left; display: inline-block; margin: 15px 0;">
                            <li>Votre connexion internet</li>
                            <li>La console du navigateur (F12) pour les erreurs</li>
                            <li>Que JavaScript est activ√©</li>
                        </ul>
                        <button onclick="location.reload()" class="btn btn-primary" style="margin-top: 20px;">
                            üîÑ R√©essayer
                        </button>
                        <button onclick="window.showSafeMode()" class="btn btn-secondary" style="margin-top: 10px;">
                            üîß Mode sans √©chec
                        </button>
                    </div>
                `;
                
                if (subTitle) subTitle.style.display = 'none';
            }
        }, 10000); // 10 secondes
        
        // Fonction de mode sans √©chec
        window.showSafeMode = function() {
            if (confirm('Mode sans √©chec :\n‚Ä¢ D√©sactiver le chargement des modules\n‚Ä¢ Effacer le cache local\n‚Ä¢ R√©initialiser l\'interface\n\nContinuer ?')) {
                localStorage.clear();
                sessionStorage.clear();
                location.reload();
            }
        };
        
        // Initialisation de l'application (redondante avec main.js mais s√©curis√©e)
        document.addEventListener('DOMContentLoaded', function() {
            console.log('‚úÖ DOM charg√© - d√©marrage application');
            
            // Masquer le chargement initial apr√®s 2 secondes max
            setTimeout(function() {
                const loading = document.getElementById('initial-loading');
                if (loading) {
                    loading.style.display = 'none';
                }
                
                const subTitle = document.getElementById('sub-title');
                if (subTitle) {
                    subTitle.style.display = 'block';
                }
            }, 2000);
        });
    </script>
</body>
</html>
